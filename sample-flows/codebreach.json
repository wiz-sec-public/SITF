{
  "metadata": {
    "name": "Attack Flow",
    "created": "2026-01-21T12:26:31.806Z",
    "version": "1.0",
    "framework": "SITF"
  },
  "nodes": [
    {
      "id": "entryPoint-1768991203224",
      "type": "entryPoint",
      "position": {
        "x": 356.5239034847598,
        "y": 19.667510766565044
      },
      "data": {
        "label": "Producer entry point"
      },
      "zIndex": 10,
      "width": 181,
      "height": 46,
      "selected": false,
      "positionAbsolute": {
        "x": 356.5239034847598,
        "y": 19.667510766565044
      },
      "dragging": false
    },
    {
      "id": "component-1768991207637",
      "type": "component",
      "position": {
        "x": 343.018001948019,
        "y": 116.5
      },
      "data": {
        "label": "CI/CD",
        "componentId": "cicd",
        "techniques": [],
        "customLabel": "AWS CodeBuild project"
      },
      "zIndex": -1,
      "width": 210,
      "height": 420,
      "selected": false,
      "positionAbsolute": {
        "x": 347.018001948019,
        "y": 116.5
      },
      "dragging": false,
      "style": {
        "width": 210,
        "height": 420
      },
      "resizing": false
    },
    {
      "id": "technique-1768991226956",
      "type": "technique",
      "position": {
        "x": 367.3597252764436,
        "y": 212.6977950127523
      },
      "data": {
        "id": "T-C020",
        "name": "CI/CD Misconfiguration Exploitation",
        "component": "cicd",
        "stage": "Initial Access",
        "description": "Attacker exploits misconfiguration in CI/CD platform",
        "risks": [
          "Misconfigured CI/CD instances"
        ],
        "controls": [
          "CSPM/CNAPP"
        ],
        "customLabel": "Non-anchored usernames"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 367.3597252764436,
        "y": 212.6977950127523
      },
      "dragging": false
    },
    {
      "id": "component-1768991270170",
      "type": "component",
      "position": {
        "x": 603.830884791914,
        "y": 118.12803785642427
      },
      "data": {
        "label": "VCS",
        "componentId": "vcs",
        "techniques": [],
        "customLabel": "aws/aws-sdk-js-v3"
      },
      "zIndex": -1,
      "width": 223,
      "height": 392,
      "selected": false,
      "positionAbsolute": {
        "x": 603.830884791914,
        "y": 118.12803785642427
      },
      "dragging": false,
      "style": {
        "width": 223,
        "height": 392
      },
      "resizing": false
    },
    {
      "id": "technique-1768993746458",
      "type": "technique",
      "position": {
        "x": 367.35972527644367,
        "y": 381.3899963383358
      },
      "data": {
        "id": "T-C005",
        "name": "Secret Exfiltration from Workflow",
        "component": "cicd",
        "stage": "Discovery and Lateral Movement",
        "description": "Attacker extracts secrets from CI/CD workflow execution",
        "risks": [
          "Workflow with access to secrets",
          "No runtime monitoring",
          "Secrets in workflow logs",
          "Overprivileged secrets"
        ],
        "controls": [
          "OIDC setup in workflows",
          "Runtime agent on runner",
          "Secret scanning",
          "Minimal workflow permissions",
          "Log sanitization"
        ],
        "customLabel": "aws-sdk-js-automation PAT"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 367.35972527644367,
        "y": 381.3899963383358
      },
      "dragging": false
    },
    {
      "id": "technique-1768994021428",
      "type": "technique",
      "position": {
        "x": 632.8056118471686,
        "y": 222.44312240576585
      },
      "data": {
        "id": "T-V001",
        "name": "Abuse Credentials for VCS Access",
        "component": "vcs",
        "stage": "Initial Access",
        "description": "Attacker uses stolen credentials to access VCS",
        "risks": [
          "Lack of 2FA / phishing protection",
          "Credentials in org public repos",
          "Credentials in public repos of org members",
          "Credentials in workflow logs",
          "Previous breaches",
          "Fine-grained PATs not enforced",
          "PATs without expiration"
        ],
        "controls": [
          "Mandatory MFA",
          "IDP / SSO setup",
          "Enforcing fine-grained PATs",
          "Enforcing PAT expiration",
          "Secret scanning on org",
          "Secret scanning on personal repos"
        ]
      },
      "zIndex": 10,
      "width": 160,
      "height": 96,
      "selected": false,
      "positionAbsolute": {
        "x": 632.8056118471686,
        "y": 222.44312240576585
      },
      "dragging": false
    },
    {
      "id": "component-1768995095277",
      "type": "component",
      "position": {
        "x": 877.3985174612267,
        "y": 121.10027077355844
      },
      "data": {
        "label": "Registry",
        "componentId": "registry",
        "techniques": [],
        "customLabel": "GitHub and NPM registries"
      },
      "zIndex": -1,
      "width": 225,
      "height": 247,
      "selected": false,
      "positionAbsolute": {
        "x": 877.3985174612267,
        "y": 121.10027077355844
      },
      "dragging": false,
      "style": {
        "width": 225,
        "height": 247
      },
      "resizing": false
    },
    {
      "id": "technique-1768995132605",
      "type": "technique",
      "position": {
        "x": 909.4733807295452,
        "y": 225.1151071464514
      },
      "data": {
        "id": "T-R004",
        "name": "Publishing Malicious Package",
        "component": "registry",
        "stage": "Discovery and Lateral Movement",
        "description": "Attacker publishes malicious package to registry",
        "risks": [
          "Overprivileged NPM token",
          "Lack of provenance",
          "Lack of trusted publishing",
          "No package signing"
        ],
        "controls": [
          "Trusted publishing",
          "Provenance attestation",
          "MFA for registry account",
          "Package signing and verification",
          "OIDC for publishing"
        ],
        "customLabel": "aws-sdk-js-v3"
      },
      "zIndex": 10,
      "width": 160,
      "height": 97,
      "selected": false,
      "positionAbsolute": {
        "x": 909.4733807295452,
        "y": 225.1151071464514
      },
      "dragging": false
    },
    {
      "id": "component-1768995200655",
      "type": "component",
      "position": {
        "x": 1165.164836440501,
        "y": 122.51827465157032
      },
      "data": {
        "label": "Endpoint/IDE",
        "componentId": "endpoint",
        "techniques": [],
        "customLabel": "Dev endpoints with AWS Console"
      },
      "zIndex": -1,
      "width": 213,
      "height": 228,
      "selected": false,
      "positionAbsolute": {
        "x": 1165.164836440501,
        "y": 122.51827465157032
      },
      "dragging": false,
      "style": {
        "width": 213,
        "height": 228
      },
      "resizing": false
    },
    {
      "id": "technique-1768995218365",
      "type": "technique",
      "position": {
        "x": 1187.0314412349449,
        "y": 228.414285572162
      },
      "data": {
        "id": "T-E001",
        "name": "Malicious Execution on Endpoint",
        "component": "endpoint",
        "stage": "Initial Access",
        "description": "Attacker executes malicious code on developer workstation",
        "risks": [
          "Using untrusted IDE extensions",
          "Using untrusted software packages on endpoints",
          "No EDR",
          "Lack of application sandboxing",
          "Package installation scripts enabled",
          "Direct downloads from public registries"
        ],
        "controls": [
          "Local registry proxy with filtering",
          "EDR on endpoint",
          "IDE sandboxing",
          "Mandating signed extensions",
          "Package version pinning",
          "Automated maintainer reputation and hygiene checks",
          "Application whitelisting",
          "Disable package installation scripts (--ignore-scripts)"
        ]
      },
      "zIndex": 10,
      "width": 160,
      "height": 96,
      "selected": false,
      "positionAbsolute": {
        "x": 1187.0314412349449,
        "y": 228.414285572162
      },
      "dragging": false
    },
    {
      "id": "entryPoint-1768997145794",
      "type": "entryPoint",
      "position": {
        "x": 1173.3549824241868,
        "y": 18.589088944998707
      },
      "data": {
        "label": "Consumer entry point"
      },
      "zIndex": 10,
      "width": 190,
      "height": 46,
      "selected": false,
      "dragging": false,
      "positionAbsolute": {
        "x": 1173.3549824241868,
        "y": 18.589088944998707
      }
    },
    {
      "id": "technique-1768997680252",
      "type": "technique",
      "position": {
        "x": 632.4156946524981,
        "y": 364.2159843267608
      },
      "data": {
        "id": "T-V010",
        "name": "Malicious Code Modification in Repository",
        "component": "vcs",
        "stage": "Post-Compromise",
        "description": "Attacker with repository access directly modifies source code to inject backdoors, malicious logic, or vulnerabilities into the codebase",
        "risks": [
          "Overprivileged VCS access",
          "No code review requirements",
          "Direct push to protected branches allowed",
          "Lack of commit signing",
          "No automated code security scanning",
          "Insufficient branch protection rules",
          "No detection of suspicious code patterns"
        ],
        "controls": [
          "Branch protection rules (VCS)",
          "Require code owner approval",
          "Mandatory code review by multiple reviewers",
          "Commit signing enforcement",
          "Automated code security scanning (SAST)",
          "Detection infra on audit logs (VCS)",
          "Minimal VCS permissions (principle of least privilege)",
          "Code change anomaly detection",
          "Pre-commit hooks for security checks"
        ]
      },
      "zIndex": 10,
      "width": 160,
      "height": 96,
      "selected": false,
      "positionAbsolute": {
        "x": 632.4156946524981,
        "y": 364.2159843267608
      },
      "dragging": false
    },
    {
      "id": "exitPoint-1768998298662",
      "type": "exitPoint",
      "position": {
        "x": 1214.1740778025812,
        "y": 442.56777561272906
      },
      "data": {
        "label": "Custom"
      },
      "zIndex": 10,
      "width": 107,
      "height": 46,
      "selected": false,
      "positionAbsolute": {
        "x": 1214.1740778025812,
        "y": 442.56777561272906
      },
      "dragging": false
    }
  ],
  "edges": [
    {
      "zIndex": 100,
      "source": "entryPoint-1768991203224",
      "sourceHandle": "bottom",
      "target": "technique-1768991226956",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-entryPoint-1768991203224bottom-technique-1768991226956top"
    },
    {
      "zIndex": 100,
      "source": "technique-1768991226956",
      "sourceHandle": "bottom",
      "target": "technique-1768993746458",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1768991226956bottom-technique-1768993746458top"
    },
    {
      "zIndex": 100,
      "source": "technique-1768995132605",
      "sourceHandle": "bottom",
      "target": "technique-1768995218365",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1768995132605bottom-technique-1768995218365top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "entryPoint-1768997145794",
      "sourceHandle": "bottom",
      "target": "technique-1768995218365",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-entryPoint-1768997145794bottom-technique-1768995218365top"
    },
    {
      "zIndex": 100,
      "source": "technique-1768993746458",
      "sourceHandle": "bottom",
      "target": "technique-1768994021428",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1768993746458bottom-technique-1768994021428top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "technique-1768994021428",
      "sourceHandle": "bottom",
      "target": "technique-1768997680252",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1768994021428bottom-technique-1768997680252top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "technique-1768997680252",
      "sourceHandle": "bottom",
      "target": "technique-1768995132605",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1768997680252bottom-technique-1768995132605top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "technique-1768995218365",
      "sourceHandle": "bottom",
      "target": "exitPoint-1768998298662",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1768995218365bottom-exitPoint-1768998298662top"
    }
  ]
}