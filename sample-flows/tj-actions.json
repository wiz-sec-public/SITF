{
  "metadata": {
    "name": "Attack Flow",
    "created": "2026-01-26T13:57:21.900Z",
    "version": "1.0",
    "framework": "SITF"
  },
  "nodes": [
    {
      "id": "entryPoint-1765192751091",
      "type": "entryPoint",
      "position": {
        "x": -172.69366548497499,
        "y": 0.36862186165051014
      },
      "data": {
        "label": "Producer initial access"
      },
      "zIndex": 10,
      "width": 195,
      "height": 46,
      "selected": false,
      "positionAbsolute": {
        "x": -172.69366548497499,
        "y": 0.36862186165051014
      },
      "dragging": false
    },
    {
      "id": "component-1765192761789",
      "type": "component",
      "position": {
        "x": -186.37494894187031,
        "y": 108.38032802982985
      },
      "data": {
        "label": "CI/CD",
        "componentId": "cicd",
        "techniques": [],
        "customLabel": "Sonatype GitHub Actions"
      },
      "zIndex": -1,
      "width": 226,
      "height": 374,
      "selected": false,
      "positionAbsolute": {
        "x": -186.37494894187031,
        "y": 108.38032802982985
      },
      "dragging": false,
      "style": {
        "width": 226,
        "height": 374
      },
      "resizing": false
    },
    {
      "id": "component-1765192768857",
      "type": "component",
      "position": {
        "x": 625.7937349708914,
        "y": 115.50715976681073
      },
      "data": {
        "label": "VCS",
        "componentId": "vcs",
        "techniques": [],
        "customLabel": "tj-actions org"
      },
      "zIndex": -1,
      "width": 232,
      "height": 359,
      "selected": false,
      "positionAbsolute": {
        "x": 625.7937349708914,
        "y": 115.50715976681073
      },
      "dragging": false,
      "style": {
        "width": 232,
        "height": 359
      },
      "resizing": false
    },
    {
      "id": "technique-1765192795298",
      "type": "technique",
      "position": {
        "x": -155.22101102466354,
        "y": 200.33845128204314
      },
      "data": {
        "id": "T-C003",
        "name": "PWN Request / Poisoned Pipeline Execution",
        "component": "cicd",
        "stage": "Initial Access",
        "description": "Attacker submits malicious PR that triggers workflow with elevated privileges",
        "risks": [
          "Misconfigured repo - visibility",
          "Misconfigured VCS access - external contributors",
          "Allowing PRs from forks",
          "Usage of pull_request_target/workflow_run",
          "Default workflow permissions set to WRITE",
          "Default workflow permissions set to approve PR",
          "Workflows with access to secrets"
        ],
        "controls": [
          "Branch protection rules (VCS)",
          "Private repo (VCS)",
          "CICD scanning tools",
          "Require explicit approval for workflows from forks (VCS)",
          "Minimal workflow permissions",
          "Default workflow permissions not set to approve PRs"
        ]
      },
      "zIndex": 10,
      "width": 160,
      "height": 96,
      "selected": false,
      "positionAbsolute": {
        "x": -155.22101102466354,
        "y": 200.33845128204314
      },
      "dragging": false
    },
    {
      "id": "technique-1765192833166",
      "type": "technique",
      "position": {
        "x": -155.58687992711702,
        "y": 330.9545673287001
      },
      "data": {
        "id": "T-C005",
        "name": "Secret Exfiltration from Workflow",
        "component": "cicd",
        "stage": "Discovery and Lateral Movement",
        "description": "Attacker extracts secrets from CI/CD workflow execution",
        "risks": [
          "Workflow with access to secrets",
          "No runtime monitoring",
          "Secrets in workflow logs",
          "Overprivileged secrets"
        ],
        "controls": [
          "OIDC setup in workflows",
          "Runtime agent on runner",
          "Secret scanning",
          "Minimal workflow permissions",
          "Log sanitization"
        ],
        "customLabel": "Exfiltrating maintainer PAT"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": -155.58687992711702,
        "y": 330.9545673287001
      },
      "dragging": false
    },
    {
      "id": "component-1769432010391",
      "type": "component",
      "position": {
        "x": 919.3024945468221,
        "y": 103.58492794928935
      },
      "data": {
        "label": "CI/CD",
        "componentId": "cicd",
        "techniques": [],
        "customLabel": "Coinbase and other consumers of tj-actions/changed-files"
      },
      "zIndex": -1,
      "width": 213,
      "height": 373,
      "selected": true,
      "positionAbsolute": {
        "x": 919.3024945468221,
        "y": 103.58492794928935
      },
      "dragging": false,
      "style": {
        "width": 213,
        "height": 373
      },
      "resizing": false
    },
    {
      "id": "entryPoint-1769432017903",
      "type": "entryPoint",
      "position": {
        "x": 932.1552523738708,
        "y": -14.766886881407046
      },
      "data": {
        "label": "Consumer initial access"
      },
      "zIndex": 10,
      "width": 204,
      "height": 46,
      "selected": false,
      "positionAbsolute": {
        "x": 932.1552523738708,
        "y": -14.766886881407046
      },
      "dragging": false
    },
    {
      "id": "technique-1769432066376",
      "type": "technique",
      "position": {
        "x": 662.3715209386817,
        "y": 344.8713308612762
      },
      "data": {
        "id": "T-V010",
        "name": "Malicious Code Modification in Repository",
        "component": "vcs",
        "stage": "Post-Compromise",
        "description": "Attacker with repository access directly modifies source code to inject backdoors, malicious logic, or vulnerabilities into the codebase",
        "risks": [
          "Overprivileged VCS access",
          "No code review requirements",
          "Direct push to protected branches allowed",
          "Lack of commit signing",
          "No automated code security scanning",
          "Insufficient branch protection rules",
          "No detection of suspicious code patterns"
        ],
        "controls": [
          "Branch protection rules (VCS)",
          "Require code owner approval",
          "Mandatory code review by multiple reviewers",
          "Commit signing enforcement",
          "Automated code security scanning (SAST)",
          "Detection infra on audit logs (VCS)",
          "Minimal VCS permissions (principle of least privilege)",
          "Code change anomaly detection",
          "Pre-commit hooks for security checks"
        ],
        "customLabel": "reviewdog/actions-setup"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 662.3715209386817,
        "y": 344.8713308612762
      },
      "dragging": false
    },
    {
      "id": "technique-1769432131294",
      "type": "technique",
      "position": {
        "x": 953.4853537511602,
        "y": 339.5932985275956
      },
      "data": {
        "id": "T-C018",
        "name": "Data Exfiltration from CI/CD",
        "component": "cicd",
        "stage": "Post-Compromise",
        "description": "Attacker exfiltrates build artifacts, logs, secrets, and sensitive data from CI/CD system over network",
        "risks": [
          "No network egress monitoring",
          "Unrestricted outbound network access from runners",
          "Build artifacts contain sensitive data",
          "Logs contain secrets or sensitive information",
          "No DLP on CI/CD network"
        ],
        "controls": [
          "Network DLP",
          "Egress traffic monitoring and filtering",
          "Runtime agent on runner",
          "Large data transfer detection",
          "Log sanitization",
          "Artifact encryption",
          "Detection infra on audit logs (CI/CD)",
          "Network segmentation (CI/CD from internet)"
        ]
      },
      "zIndex": 10,
      "width": 160,
      "height": 96,
      "selected": false,
      "positionAbsolute": {
        "x": 953.4853537511602,
        "y": 339.5932985275956
      },
      "dragging": false
    },
    {
      "id": "technique-1769432177681",
      "type": "technique",
      "position": {
        "x": 953.5644448729555,
        "y": 201.20304895400676
      },
      "data": {
        "id": "T-C002",
        "name": "Malicious Execution in Workflow Context",
        "component": "cicd",
        "stage": "Initial Access",
        "description": "Attacker executes malicious code within CI/CD workflow",
        "risks": [
          "Using untrusted GitHub actions",
          "Using untrusted GitHub Apps",
          "Using untrusted reusable workflows",
          "Using untrusted SW packages on runners",
          "Using untrusted container / VM image for runners",
          "Lack of GitHub action pinning"
        ],
        "controls": [
          "Pinning 3rd-party actions",
          "Action whitelisting",
          "Automated maintainer reputation and hygiene checks",
          "Requiring code owner approval (VCS)",
          "Branch protection rules (VCS)",
          "Runner SBOM",
          "Image scanning"
        ],
        "customLabel": "tj-actions/eslint-changed-files"
      },
      "zIndex": 10,
      "width": 160,
      "height": 96,
      "selected": false,
      "positionAbsolute": {
        "x": 953.5644448729555,
        "y": 201.20304895400676
      },
      "dragging": false
    },
    {
      "id": "component-1769434229289",
      "type": "component",
      "position": {
        "x": 97.57981546694776,
        "y": 110.29719314023612
      },
      "data": {
        "label": "VCS",
        "componentId": "vcs",
        "techniques": [],
        "customLabel": "Reviewdog"
      },
      "zIndex": -1,
      "width": 207,
      "height": 372,
      "selected": false,
      "positionAbsolute": {
        "x": 97.57981546694776,
        "y": 110.29719314023612
      },
      "dragging": false,
      "style": {
        "width": 207,
        "height": 372
      },
      "resizing": false
    },
    {
      "id": "technique-1769434251701",
      "type": "technique",
      "position": {
        "x": 121.50935719382653,
        "y": 199.84813450490174
      },
      "data": {
        "id": "T-V001",
        "name": "Abuse Credentials for VCS Access",
        "component": "vcs",
        "stage": "Initial Access",
        "description": "Attacker uses stolen credentials to access VCS",
        "risks": [
          "Lack of 2FA / phishing protection",
          "Credentials in org public repos",
          "Credentials in public repos of org members",
          "Credentials in workflow logs",
          "Previous breaches",
          "Fine-grained PATs not enforced",
          "PATs without expiration"
        ],
        "controls": [
          "Mandatory MFA",
          "IDP / SSO setup",
          "Enforcing fine-grained PATs",
          "Enforcing PAT expiration",
          "Secret scanning on org",
          "Secret scanning on personal repos"
        ],
        "customLabel": ""
      },
      "zIndex": 10,
      "width": 160,
      "height": 96,
      "selected": false,
      "positionAbsolute": {
        "x": 121.50935719382653,
        "y": 199.84813450490174
      },
      "dragging": false
    },
    {
      "id": "technique-1769434444473",
      "type": "technique",
      "position": {
        "x": 121.49896600956174,
        "y": 345.7030800532832
      },
      "data": {
        "id": "T-V010",
        "name": "Malicious Code Modification in Repository",
        "component": "vcs",
        "stage": "Post-Compromise",
        "description": "Attacker with repository access directly modifies source code to inject backdoors, malicious logic, or vulnerabilities into the codebase",
        "risks": [
          "Overprivileged VCS access",
          "No code review requirements",
          "Direct push to protected branches allowed",
          "Lack of commit signing",
          "No automated code security scanning",
          "Insufficient branch protection rules",
          "No detection of suspicious code patterns"
        ],
        "controls": [
          "Branch protection rules (VCS)",
          "Require code owner approval",
          "Mandatory code review by multiple reviewers",
          "Commit signing enforcement",
          "Automated code security scanning (SAST)",
          "Detection infra on audit logs (VCS)",
          "Minimal VCS permissions (principle of least privilege)",
          "Code change anomaly detection",
          "Pre-commit hooks for security checks"
        ],
        "customLabel": "reviewdog/actions-setup"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 121.49896600956174,
        "y": 345.7030800532832
      },
      "dragging": false
    },
    {
      "id": "component-1769434713494",
      "type": "component",
      "position": {
        "x": 363.174743858297,
        "y": 107.71446346290085
      },
      "data": {
        "label": "CI/CD",
        "componentId": "cicd",
        "techniques": [],
        "customLabel": "tj-actions workflows"
      },
      "zIndex": -1,
      "width": 218,
      "height": 394,
      "selected": false,
      "positionAbsolute": {
        "x": 363.174743858297,
        "y": 107.71446346290085
      },
      "dragging": false,
      "style": {
        "width": 218,
        "height": 394
      },
      "resizing": false
    },
    {
      "id": "technique-1769434785561",
      "type": "technique",
      "position": {
        "x": 391.6499238815615,
        "y": 196.94746620026513
      },
      "data": {
        "id": "T-C002",
        "name": "Malicious Execution in Workflow Context",
        "component": "cicd",
        "stage": "Initial Access",
        "description": "Attacker executes malicious code within CI/CD workflow",
        "risks": [
          "Using untrusted GitHub actions",
          "Using untrusted GitHub Apps",
          "Using untrusted reusable workflows",
          "Using untrusted SW packages on runners",
          "Using untrusted container / VM image for runners",
          "Lack of GitHub action pinning"
        ],
        "controls": [
          "Pinning 3rd-party actions",
          "Action whitelisting",
          "Automated maintainer reputation and hygiene checks",
          "Requiring code owner approval (VCS)",
          "Branch protection rules (VCS)",
          "Runner SBOM",
          "Image scanning"
        ],
        "customLabel": "tj-actions/eslint-changed-files"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 391.6499238815615,
        "y": 196.94746620026513
      },
      "dragging": false
    },
    {
      "id": "technique-1769434802590",
      "type": "technique",
      "position": {
        "x": 391.1756269090455,
        "y": 341.5226499634995
      },
      "data": {
        "id": "T-C005",
        "name": "Secret Exfiltration from Workflow",
        "component": "cicd",
        "stage": "Discovery and Lateral Movement",
        "description": "Attacker extracts secrets from CI/CD workflow execution",
        "risks": [
          "Workflow with access to secrets",
          "No runtime monitoring",
          "Secrets in workflow logs",
          "Overprivileged secrets"
        ],
        "controls": [
          "OIDC setup in workflows",
          "Runtime agent on runner",
          "Secret scanning",
          "Minimal workflow permissions",
          "Log sanitization"
        ],
        "customLabel": "tj-actions/eslint-changed-files"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 391.1756269090455,
        "y": 341.5226499634995
      },
      "dragging": false
    },
    {
      "id": "technique-1769434837006",
      "type": "technique",
      "position": {
        "x": 661.5197613299831,
        "y": 196.5555054189387
      },
      "data": {
        "id": "T-V001",
        "name": "Abuse Credentials for VCS Access",
        "component": "vcs",
        "stage": "Initial Access",
        "description": "Attacker uses stolen credentials to access VCS",
        "risks": [
          "Lack of 2FA / phishing protection",
          "Credentials in org public repos",
          "Credentials in public repos of org members",
          "Credentials in workflow logs",
          "Previous breaches",
          "Fine-grained PATs not enforced",
          "PATs without expiration"
        ],
        "controls": [
          "Mandatory MFA",
          "IDP / SSO setup",
          "Enforcing fine-grained PATs",
          "Enforcing PAT expiration",
          "Secret scanning on org",
          "Secret scanning on personal repos"
        ],
        "customLabel": ""
      },
      "zIndex": 10,
      "width": 160,
      "height": 96,
      "selected": false,
      "positionAbsolute": {
        "x": 661.5197613299831,
        "y": 196.5555054189387
      },
      "dragging": false
    },
    {
      "id": "exitPoint-1769434992925",
      "type": "exitPoint",
      "position": {
        "x": 961.1546862975266,
        "y": 538.3341375439926
      },
      "data": {
        "label": "Future Breach"
      },
      "zIndex": 10,
      "width": 144,
      "height": 46,
      "selected": false,
      "positionAbsolute": {
        "x": 961.1546862975266,
        "y": 538.3341375439926
      },
      "dragging": false
    }
  ],
  "edges": [
    {
      "zIndex": 1000,
      "source": "entryPoint-1765192751091",
      "sourceHandle": "bottom",
      "target": "technique-1765192795298",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "markerEnd": {
        "type": "arrowclosed"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-entryPoint-1765192751091bottom-technique-1765192795298top",
      "selected": false
    },
    {
      "zIndex": 1000,
      "source": "technique-1765192795298",
      "sourceHandle": "bottom",
      "target": "technique-1765192833166",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "markerEnd": {
        "type": "arrowclosed"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1765192795298bottom-technique-1765192833166top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "technique-1769432066376",
      "sourceHandle": "bottom",
      "target": "technique-1769432177681",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1769432066376bottom-technique-1769432177681top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "entryPoint-1769432017903",
      "sourceHandle": "bottom",
      "target": "technique-1769432177681",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-entryPoint-1769432017903bottom-technique-1769432177681top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "technique-1765192833166",
      "sourceHandle": "bottom",
      "target": "technique-1769434251701",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1765192833166bottom-technique-1769434251701top"
    },
    {
      "zIndex": 100,
      "source": "technique-1769434251701",
      "sourceHandle": "bottom",
      "target": "technique-1769434444473",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1769434251701bottom-technique-1769434444473top"
    },
    {
      "zIndex": 100,
      "source": "technique-1769434444473",
      "sourceHandle": "bottom",
      "target": "technique-1769434785561",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1769434444473bottom-technique-1769434785561top"
    },
    {
      "zIndex": 100,
      "source": "technique-1769434785561",
      "sourceHandle": "bottom",
      "target": "technique-1769434802590",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1769434785561bottom-technique-1769434802590top"
    },
    {
      "zIndex": 100,
      "source": "technique-1769434802590",
      "sourceHandle": "bottom",
      "target": "technique-1769434837006",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1769434802590bottom-technique-1769434837006top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "technique-1769434837006",
      "sourceHandle": "bottom",
      "target": "technique-1769432066376",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1769434837006bottom-technique-1769432066376top"
    },
    {
      "zIndex": 100,
      "source": "technique-1769432177681",
      "sourceHandle": "bottom",
      "target": "technique-1769432131294",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1769432177681bottom-technique-1769432131294top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "technique-1769432131294",
      "sourceHandle": "bottom",
      "target": "exitPoint-1769434992925",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1769432131294bottom-exitPoint-1769434992925top",
      "selected": false
    }
  ]
}