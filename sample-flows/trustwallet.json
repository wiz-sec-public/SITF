{
  "metadata": {
    "name": "Attack Flow",
    "created": "2025-12-28T09:04:16.088Z",
    "version": "1.0",
    "framework": "SITF"
  },
  "nodes": [
    {
      "id": "entryPoint-1766911301740",
      "type": "entryPoint",
      "position": {
        "x": 332.9054584113875,
        "y": 56.10161594040824
      },
      "data": {
        "label": "Previous breach"
      },
      "zIndex": 10,
      "width": 155,
      "height": 46,
      "selected": false,
      "dragging": false,
      "positionAbsolute": {
        "x": 332.9054584113875,
        "y": 56.10161594040824
      }
    },
    {
      "id": "component-1766911495859",
      "type": "component",
      "position": {
        "x": 311.5128698174801,
        "y": 165.6020998832036
      },
      "data": {
        "label": "Registry",
        "componentId": "registry",
        "techniques": [],
        "customLabel": "TrustWallet Chrome Web Store"
      },
      "zIndex": -1,
      "width": 200,
      "height": 377,
      "selected": false,
      "positionAbsolute": {
        "x": 311.5128698174801,
        "y": 165.6020998832036
      },
      "dragging": false,
      "style": {
        "width": 200,
        "height": 377
      },
      "resizing": false
    },
    {
      "id": "technique-1766911549917",
      "type": "technique",
      "position": {
        "x": 330.7439816741254,
        "y": 257.4402572522459
      },
      "data": {
        "id": "T-R001",
        "name": "Abuse Credentials for Registry Access",
        "component": "registry",
        "stage": "Initial Access",
        "description": "Attacker uses stolen credentials to access registry",
        "risks": [
          "Lack of 2FA / phishing protection",
          "Default credentials / bad out-of-the-box config",
          "Credentials in public images",
          "Credentials in workflow logs",
          "Previous breaches"
        ],
        "controls": [
          "Mandatory MFA",
          "IDP / SSO setup",
          "Secret scanning",
          "CSPM monitoring"
        ],
        "customLabel": "Creds from shai-hulud-2"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 330.7439816741254,
        "y": 257.4402572522459
      },
      "dragging": false
    },
    {
      "id": "component-1766911581572",
      "type": "component",
      "position": {
        "x": 612.5563944877894,
        "y": 164.97715362243935
      },
      "data": {
        "label": "Endpoint/IDE",
        "componentId": "endpoint",
        "techniques": [],
        "customLabel": "Extension users"
      },
      "zIndex": -1,
      "width": 211,
      "height": 380,
      "selected": false,
      "positionAbsolute": {
        "x": 612.5563944877894,
        "y": 164.97715362243935
      },
      "dragging": false,
      "style": {
        "width": 211,
        "height": 380
      },
      "resizing": false
    },
    {
      "id": "technique-1766912045967",
      "type": "technique",
      "position": {
        "x": 330.7439816741255,
        "y": 407.00995479504564
      },
      "data": {
        "id": "T-R004",
        "name": "Publishing Malicious Package",
        "component": "registry",
        "stage": "Discovery and Lateral Movement",
        "description": "Attacker publishes malicious package to registry",
        "risks": [
          "Overprivileged NPM token",
          "Lack of provenance",
          "Lack of trusted publishing",
          "No package signing"
        ],
        "controls": [
          "Trusted publishing",
          "Provenance attestation",
          "MFA for registry account",
          "Package signing and verification",
          "OIDC for publishing"
        ],
        "customLabel": "Extension v2.8"
      },
      "zIndex": 10,
      "width": 160,
      "height": 97,
      "selected": false,
      "positionAbsolute": {
        "x": 330.7439816741255,
        "y": 407.00995479504564
      },
      "dragging": false
    },
    {
      "id": "technique-1766912075759",
      "type": "technique",
      "position": {
        "x": 634.4640732224206,
        "y": 264.61004301994336
      },
      "data": {
        "id": "T-E001",
        "name": "Malicious Execution on Endpoint",
        "component": "endpoint",
        "stage": "Initial Access",
        "description": "Attacker executes malicious code on developer workstation",
        "risks": [
          "Using untrusted IDE extensions",
          "Using untrusted software packages on endpoints",
          "No EDR",
          "Lack of application sandboxing"
        ],
        "controls": [
          "EDR on endpoint",
          "IDE sandboxing",
          "Mandating signed extensions",
          "Package version pinning",
          "Application whitelisting"
        ],
        "customLabel": "Within browser"
      },
      "zIndex": 10,
      "width": 160,
      "height": 97,
      "selected": false,
      "positionAbsolute": {
        "x": 634.4640732224206,
        "y": 264.61004301994336
      },
      "dragging": false
    },
    {
      "id": "exitPoint-1766912568540",
      "type": "exitPoint",
      "position": {
        "x": 647.7239532486348,
        "y": 589.9435489926537
      },
      "data": {
        "label": "Stolen funds"
      },
      "zIndex": 10,
      "width": 135,
      "height": 46,
      "selected": false,
      "dragging": false,
      "positionAbsolute": {
        "x": 647.7239532486348,
        "y": 589.9435489926537
      }
    },
    {
      "id": "technique-1766912630507",
      "type": "technique",
      "position": {
        "x": 634.5181443242172,
        "y": 391.8564151263937
      },
      "data": {
        "id": "T-E003",
        "name": "Harvest Local Secrets / Credentials from Endpoint",
        "component": "endpoint",
        "stage": "Discovery and Lateral Movement",
        "description": "Attacker extracts credentials stored on developer machine",
        "risks": [
          "Credentials stored in plaintext",
          "Production credentials on developer machines",
          "No local DLP",
          "SSH keys without passwords",
          "Cloud credentials in environment variables"
        ],
        "controls": [
          "Local DLP",
          "EDR on endpoint",
          "Credential manager enforcement",
          "No production credentials on endpoints",
          "Encrypted credential storage"
        ]
      },
      "zIndex": 10,
      "width": 160,
      "height": 96,
      "selected": false,
      "positionAbsolute": {
        "x": 634.5181443242172,
        "y": 391.8564151263937
      },
      "dragging": false
    }
  ],
  "edges": [
    {
      "zIndex": 100,
      "source": "entryPoint-1766911301740",
      "sourceHandle": "bottom",
      "target": "technique-1766911549917",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-entryPoint-1766911301740bottom-technique-1766911549917top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "technique-1766911549917",
      "sourceHandle": "bottom",
      "target": "technique-1766912045967",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1766911549917bottom-technique-1766912045967top"
    },
    {
      "zIndex": 100,
      "source": "technique-1766912045967",
      "sourceHandle": "bottom",
      "target": "technique-1766912075759",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "Supply Chain",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1766912045967bottom-technique-1766912075759top",
      "selected": false
    },
    {
      "zIndex": 100,
      "source": "technique-1766912075759",
      "sourceHandle": "bottom",
      "target": "technique-1766912630507",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1766912075759bottom-technique-1766912630507top"
    },
    {
      "zIndex": 100,
      "source": "technique-1766912630507",
      "sourceHandle": "bottom",
      "target": "exitPoint-1766912568540",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "id": "reactflow__edge-technique-1766912630507bottom-exitPoint-1766912568540top"
    }
  ]
}