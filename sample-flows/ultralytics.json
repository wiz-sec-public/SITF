{
  "metadata": {
    "name": "Attack Flow",
    "created": "2026-02-18T12:58:26.117Z",
    "version": "1.0",
    "framework": "SITF"
  },
  "nodes": [
    {
      "id": "entryPoint-ultralytics-1",
      "type": "entryPoint",
      "position": {
        "x": 92.65095759539781,
        "y": -56.33896033154849
      },
      "data": {
        "label": "Malicious Fork PR"
      },
      "zIndex": 10,
      "width": 161,
      "height": 46,
      "selected": false,
      "positionAbsolute": {
        "x": 92.65095759539781,
        "y": -56.33896033154849
      },
      "dragging": false
    },
    {
      "id": "component-cicd-1",
      "type": "component",
      "position": {
        "x": 48,
        "y": 80
      },
      "data": {
        "label": "CI/CD",
        "componentId": "cicd",
        "techniques": [],
        "customLabel": "Ultralytics GitHub Actions"
      },
      "zIndex": -1,
      "width": 252,
      "height": 514,
      "style": {
        "width": 252,
        "height": 514
      },
      "selected": false,
      "dragging": false,
      "resizing": false
    },
    {
      "id": "technique-c003-1",
      "type": "technique",
      "position": {
        "x": 95,
        "y": 167.5882950717223
      },
      "data": {
        "id": "T-C003",
        "name": "PWN Request / Poisoned Pipeline Execution",
        "component": "cicd",
        "stage": "Initial Access",
        "description": "Attacker submits malicious PR that triggers workflow with elevated privileges",
        "risks": [
          "Misconfigured repo - visibility",
          "Misconfigured VCS access - external contributors",
          "Allowing PRs from forks",
          "Usage of pull_request_target/workflow_run",
          "Default workflow permissions set to WRITE",
          "Default workflow permissions set to approve PR",
          "Workflows with access to secrets"
        ],
        "controls": [
          "Branch protection rules (VCS)",
          "Private repo (VCS)",
          "CICD scanning tools",
          "Require explicit approval for workflows from forks (VCS)",
          "Minimal workflow permissions",
          "Default workflow permissions not set to approve PRs"
        ],
        "customLabel": "PRs #18018, #18020 from fork"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 95,
        "y": 167.5882950717223
      },
      "dragging": false
    },
    {
      "id": "technique-c004-1",
      "type": "technique",
      "position": {
        "x": 95,
        "y": 315.4001190120041
      },
      "data": {
        "id": "T-C004",
        "name": "Workflow Script Injection",
        "component": "cicd",
        "stage": "Post-Compromise",
        "description": "Attacker injects malicious code into workflow through user-controlled input",
        "risks": [
          "Misconfigured repo - visibility",
          "Misconfigured workflow - script injection",
          "Default workflow permissions set to WRITE",
          "Default workflow permissions set to approve PR",
          "Workflow with excessive permissions",
          "Workflow with access to secrets"
        ],
        "controls": [
          "Branch protection rules (VCS)",
          "Private repo (VCS)",
          "CICD scanning tools",
          "Minimal workflow permissions",
          "Code review for workflows"
        ],
        "customLabel": "Malicious branch name injection"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 95,
        "y": 315.4001190120041
      },
      "dragging": false
    },
    {
      "id": "technique-c011-1",
      "type": "technique",
      "position": {
        "x": 95,
        "y": 460.66739667510274
      },
      "data": {
        "id": "T-C011",
        "name": "Stealing Registry Tokens",
        "component": "cicd",
        "stage": "Discovery and Lateral Movement",
        "description": "Attacker extracts registry publishing tokens from workflow",
        "risks": [
          "Workflow with access to secrets",
          "Overprivileged registry tokens",
          "Long-lived credentials"
        ],
        "controls": [
          "OIDC setup in workflows",
          "Trusted publishing (registry)",
          "Runtime agent on runner",
          "Secret scanning"
        ],
        "customLabel": "Legacy PyPI API token stolen"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 95,
        "y": 460.66739667510274
      },
      "dragging": false
    },
    {
      "id": "component-registry-1",
      "type": "component",
      "position": {
        "x": 350,
        "y": 80
      },
      "data": {
        "label": "Registry",
        "componentId": "registry",
        "techniques": [],
        "customLabel": "PyPI"
      },
      "zIndex": -1,
      "width": 252,
      "height": 453,
      "style": {
        "width": 252,
        "height": 453
      },
      "selected": false,
      "dragging": false,
      "resizing": false
    },
    {
      "id": "technique-r001-1",
      "type": "technique",
      "position": {
        "x": 393.72772686140854,
        "y": 181.58329959622944
      },
      "data": {
        "id": "T-R001",
        "name": "Abuse Credentials for Registry Access",
        "component": "registry",
        "stage": "Initial Access",
        "description": "Attacker uses stolen credentials to access registry",
        "risks": [
          "Lack of 2FA / phishing protection",
          "Default credentials / bad out-of-the-box config",
          "Credentials in public images",
          "Credentials in workflow logs",
          "Previous breaches"
        ],
        "controls": [
          "Mandatory MFA",
          "IDP / SSO setup",
          "Secret scanning",
          "CSPM/CNAPP"
        ],
        "customLabel": "Stolen PyPI API token"
      },
      "zIndex": 10,
      "width": 160,
      "height": 97,
      "selected": false,
      "positionAbsolute": {
        "x": 393.72772686140854,
        "y": 181.58329959622944
      },
      "dragging": false
    },
    {
      "id": "technique-r004-1",
      "type": "technique",
      "position": {
        "x": 393.7277268614084,
        "y": 366.2910445556663
      },
      "data": {
        "id": "T-R004",
        "name": "Publishing Malicious Package",
        "component": "registry",
        "stage": "Discovery and Lateral Movement",
        "description": "Attacker publishes malicious package to registry",
        "risks": [
          "Overprivileged NPM token",
          "Lack of provenance",
          "Lack of trusted publishing",
          "No package signing"
        ],
        "controls": [
          "Trusted publishing",
          "Provenance attestation",
          "MFA for registry account",
          "Package signing and verification",
          "OIDC for publishing"
        ],
        "customLabel": "Versions 8.3.41, 8.3.42, 8.3.45, 8.3.46"
      },
      "zIndex": 10,
      "width": 160,
      "height": 113,
      "selected": false,
      "positionAbsolute": {
        "x": 393.7277268614084,
        "y": 366.2910445556663
      },
      "dragging": false
    },
    {
      "id": "component-endpoint-1",
      "type": "component",
      "position": {
        "x": 650,
        "y": 80
      },
      "data": {
        "label": "Endpoint/IDE",
        "componentId": "endpoint",
        "techniques": [],
        "customLabel": "Consumer Systems"
      },
      "zIndex": -1,
      "width": 244,
      "height": 415,
      "style": {
        "width": 244,
        "height": 415
      },
      "selected": false,
      "dragging": false,
      "resizing": false
    },
    {
      "id": "technique-e001-1",
      "type": "technique",
      "position": {
        "x": 695,
        "y": 185.4001190120041
      },
      "data": {
        "id": "T-E001",
        "name": "Malicious Execution on Endpoint",
        "component": "endpoint",
        "stage": "Initial Access",
        "description": "Attacker executes malicious code on developer workstation",
        "risks": [
          "Using untrusted IDE extensions",
          "Using untrusted software packages on endpoints",
          "No EDR",
          "Lack of application sandboxing",
          "Package installation scripts enabled",
          "Direct downloads from public registries"
        ],
        "controls": [
          "Local registry proxy with filtering",
          "EDR on endpoint",
          "IDE sandboxing",
          "Mandating signed extensions",
          "Package version pinning",
          "Automated maintainer reputation and hygiene checks",
          "Application whitelisting",
          "Disable package installation scripts (--ignore-scripts)"
        ],
        "customLabel": "pip install ultralytics"
      },
      "zIndex": 10,
      "width": 160,
      "height": 97,
      "selected": false,
      "positionAbsolute": {
        "x": 695,
        "y": 185.4001190120041
      },
      "dragging": false
    },
    {
      "id": "technique-e005-1",
      "type": "technique",
      "position": {
        "x": 695,
        "y": 345.9346743382015
      },
      "data": {
        "id": "T-E005",
        "name": "Cryptomining on Endpoints",
        "component": "endpoint",
        "stage": "Post-Compromise",
        "description": "Attacker uses endpoint resources for cryptocurrency mining",
        "risks": [
          "No EDR",
          "Untrusted software packages",
          "No resource monitoring"
        ],
        "controls": [
          "EDR on endpoint",
          "Resource monitoring and alerting",
          "Application whitelisting",
          "Network monitoring (detect mining pool connections)"
        ],
        "customLabel": "XMRig Monero miner"
      },
      "zIndex": 10,
      "width": 160,
      "height": 97,
      "selected": false,
      "positionAbsolute": {
        "x": 695,
        "y": 345.9346743382015
      },
      "dragging": false
    },
    {
      "id": "exitPoint-ultralytics-1",
      "type": "exitPoint",
      "position": {
        "x": 649.6852449768196,
        "y": 561.7759133937685
      },
      "data": {
        "label": "Secondary Supply Chain Attack"
      },
      "zIndex": 10,
      "width": 252,
      "height": 46,
      "selected": true,
      "positionAbsolute": {
        "x": 649.6852449768196,
        "y": 561.7759133937685
      },
      "dragging": false
    }
  ],
  "edges": [
    {
      "id": "edge-entry-c003",
      "source": "entryPoint-ultralytics-1",
      "sourceHandle": "bottom",
      "target": "technique-c003-1",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "zIndex": 100,
      "markerEnd": {
        "type": "arrowclosed"
      },
      "label": "Fork-based PR",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "selected": false
    },
    {
      "id": "edge-c003-c004",
      "source": "technique-c003-1",
      "sourceHandle": "bottom",
      "target": "technique-c004-1",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "zIndex": 100,
      "markerEnd": {
        "type": "arrowclosed"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "selected": false
    },
    {
      "id": "edge-c004-c011",
      "source": "technique-c004-1",
      "sourceHandle": "bottom",
      "target": "technique-c011-1",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "zIndex": 100,
      "markerEnd": {
        "type": "arrowclosed"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "selected": false
    },
    {
      "id": "edge-c011-r001",
      "source": "technique-c011-1",
      "sourceHandle": "right",
      "target": "technique-r001-1",
      "targetHandle": "left",
      "type": "smoothstep",
      "animated": false,
      "zIndex": 100,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "Stolen token",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "selected": false
    },
    {
      "id": "edge-r001-r004",
      "source": "technique-r001-1",
      "sourceHandle": "bottom",
      "target": "technique-r004-1",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "zIndex": 100,
      "markerEnd": {
        "type": "arrowclosed"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "selected": false
    },
    {
      "id": "edge-r004-e001",
      "source": "technique-r004-1",
      "sourceHandle": "right",
      "target": "technique-e001-1",
      "targetHandle": "left",
      "type": "smoothstep",
      "animated": false,
      "zIndex": 100,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "pip install",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "selected": false
    },
    {
      "id": "edge-e001-e005",
      "source": "technique-e001-1",
      "sourceHandle": "bottom",
      "target": "technique-e005-1",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "zIndex": 100,
      "markerEnd": {
        "type": "arrowclosed"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "selected": false
    },
    {
      "id": "edge-e005-exit",
      "source": "technique-e005-1",
      "sourceHandle": "right",
      "target": "exitPoint-ultralytics-1",
      "targetHandle": "top",
      "type": "smoothstep",
      "animated": false,
      "zIndex": 100,
      "style": {
        "stroke": "#9ca3af"
      },
      "markerEnd": {
        "type": "arrowclosed",
        "color": "#9ca3af"
      },
      "label": "",
      "labelStyle": {
        "fill": "#DC2626",
        "fontWeight": 600,
        "fontSize": 12
      },
      "labelBgStyle": {
        "fill": "#FEE2E2",
        "fillOpacity": 0.9
      },
      "selected": false
    }
  ]
}